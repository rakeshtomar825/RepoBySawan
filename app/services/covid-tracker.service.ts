import { Injectable } from '@angular/core';
import { HttpClient } from "@angular/common/http";
import { map } from "rxjs/operators";
// import * as io from 'socket.io-client';
import { Observable } from "rxjs/internal/Observable";
import { AqiComponent } from 'src/app/aqi/aqi.component';


@Injectable({
  providedIn: 'root'
})
export class CovidTrackerService {
  socket: any;
  readonly url : string = 'wss://city-ws.herokuapp.com/';
  constructor(private http: HttpClient) {
    //this.socket = new WebSocket(this.url)
  }

getCovidRecord(){
  return this.http.get<any>("https://api.apify.com/v2/key-value-stores/toDWvRj1JpTXiM8FF/records/LATEST?disableRedirect=true")
  .pipe(map((res:any) => {
    return res;
  }))
}




 webSocketAqi(){
  let url: string = "wss://city-ws.herokuapp.com/";
  let ws = new WebSocket(url)
  let aqiData :any = [];
  ws.onmessage = (data:any)=>{
    aqiData = JSON.parse(data.data);  
  }
  console.log("@@@@@",aqiData);
  return aqiData;
}






getNewsDataa(data:any){
  if(data == undefined){
    return this.http.get<any>(`https://newsapi.org/v2/top-headlines?country=in&apiKey=ce136060ef9a42e2b54b1426e0a9900a`)
    .pipe(map((res:any) => {
      return res;
    }))
}else{
  return this.http.get<any>(`https://newsapi.org/v2/everything?q=${data}&from=${new Date().toISOString().slice(0, 10)}&sortBy=publishedAt&apiKey=ce136060ef9a42e2b54b1426e0a9900a`)
  .pipe(map((res:any) => {
    return res;
  }))
}
}




getNewsData(){
    let res = {"status":"ok","totalResults":14637,"articles":[{"source":{"id":null,"name":"Turkiyegazetesi.com.tr"},"author":null,"title":"Korkunç cinayet: Uzman çavuş, nişanlısı tarafından öldürüldü","description":"İstanbul Kağıthane’de nişanlısıyla birlikte yaşayan Sahil Güvenlik Komutanlığı’nda görevli 26 yaşındaki Topçu Uzman Çavuş Zeynel Yıldırım, tartışma yaşadığı 30 yaşındaki nişanlısı tarafından 3 el ateş edilerek öldürüldü. Cinayetin ardından katil zanlısı kadın…","url":"https://www.turkiyegazetesi.com.tr/yasam/795637.aspx","urlToImage":"https://icdn.turkiyegazetesi.com.tr/images/haberler/2021_07/buyuk/korkunc-cinayet-uzman-cavus-nisanlisi-tarafindan-olduruldu-1625553582.jpg","publishedAt":"2021-07-06T06:53:44Z","content":"Olay, dün saat 19.30 sralarnda Kathane Seyrantepede meydana geldi.\r\nÖNCE TARTITI, SONRA 3 EL ATE ETTEdinilen bilgiye göre, Sahil Güvenlik Komutanlnda görevli Topçu Uzman Çavu rütbesindeki Zeynel Yldr… [+1772 chars]"},{"source":{"id":null,"name":"Madshrimps.be"},"author":"Stefan Mileschin","title":"Bitcoin mining just became easier and more profitable","description":"Thanks to China thar's gold in them thar hills\n\nThe Chinese crackdown on bitcoin miners might have caused the price to fall, but it just made mining more lucrative for the rest of the world.\n\nThe bitcoin algorithm has adjusted accordingly to make sure miner p…","url":"http://www.madshrimps.be/news/item/206878","urlToImage":null,"publishedAt":"2021-07-06T06:49:13Z","content":"Copyright © 2001-2011 Madshrimps, All rights reserved.Graphic Design by Dennis Kestelle, Programming by Maarten Menten,\r\nOverall Site design by John Meys\r\nAll information and graphics contained in Ma… [+135 chars]"},{"source":{"id":"focus","name":"Focus"},"author":"Von Gastautor Gabor Steingart","title":"Gastbeitrag von Gabor Steingart - „Wer zahlt, füttert das Ungeheuer“: Wie Cyberkriminalität deutsche Wirtschaft bedroht","description":"Auch Deutschland sind Tausende Computer vom aktuellen Cyberangriff einer russischen Hackergruppe betroffen. Doch weder unser Rechtssystem, das lahn und schläfrig ist, noch die Wirtschaft selbst sind gerüstet gegen die Attacken, die enorme Schäden verursachen.…","url":"https://www.focus.de/politik/gastbeitrag-von-gabor-steingegart-wer-zahlt-fuettert-das-ungeheuer-wie-cyberkriminalitaet-deutsche-wirtschaft-bedroht_id_13468913.html","urlToImage":"https://p6.focus.de/img/fotos/id_13468949/cyberkriminalitaet.jpg?im=Crop%3D%280%2C136%2C3000%2C1500%29%3BResize%3D%281200%2C627%29&hash=df7f39861f3ab41e3ebec7392370203c9ec488dd9140eacb0bbed00f0c592d3c","publishedAt":"2021-07-06T06:34:05Z","content":"Auch Deutschland sind Tausende Computer vom aktuellen Cyberangriff einer russischen Hackergruppe betroffen. Doch weder unser Rechtssystem, das lahn und schläfrig ist, noch die Wirtschaft selbst sind … [+3975 chars]"},{"source":{"id":null,"name":"Numerama"},"author":"Anne Cagan","title":"Miner du bitcoin est redevenu beaucoup plus facile : voilà pourquoi","description":"La fermeture de la majorité des fermes de minage basées en Chine a de lourdes répercussions sur le bitcoin. Pour faire face à cette nouvelle donne, le réseau a réajusté significativement la difficulté des puzzles mathématiques à résoudre pour miner des blocs …","url":"https://www.numerama.com/tech/723885-miner-du-bitcoin-est-redevenu-beaucoup-plus-facile-voila-pourquoi.html","urlToImage":"https://www.numerama.com/wp-content/uploads/2021/07/bitcoin-executium.jpg","publishedAt":"2021-07-06T06:31:09Z","content":"La fermeture de la majorité des fermes de minage basées en Chine a de lourdes répercussions sur le bitcoin. Pour faire face à cette nouvelle donne, le réseau a réajusté significativement la difficult… [+3827 chars]"},{"source":{"id":null,"name":"PC-WELT"},"author":"Frank Ziemann","title":"Kaseya: Erpresser fordern 70 Millionen Dollar Lösegeld","description":"Eine Erpresserbande hat Ransomware über eine 0-Day-Lücke in der Software Kaseya VSA an viele Kunden des Unternehmens verteilt.","url":"https://www.pcwelt.de/news/Kaseya-Erpresser-fordern-70-Millionen-Dollar-Loesegeld-11056530.html","urlToImage":"https://bilder.pcwelt.de/4303041_1000x500_r.jpg","publishedAt":"2021-07-06T06:27:00Z","content":"Frank Ziemann\r\nDie Ransomware-Bande REvil hat Malware, die Daten verschlüsselt, über eine Sicherheitslücke in der Software Kaseya VSA an zahlreiche Kunden des Unternehmens verteilt. Die Täter fordern… [+3288 chars]"},{"source":{"id":null,"name":"Cointelegraph"},"author":"Cointelegraph By Brian Quarmby","title":"Brazil’s ‘Bitcoin King’ arrested over 7,000 missing BTC","description":"Claudio Oliveira is facing charges of embezzlement, money laundering, and bankruptcy fraud after allegedly diverting 7,000 BTC in clients' funds.","url":"https://cointelegraph.com/news/brazil-s-bitcoin-king-arrested-over-7-000-missing-btc","urlToImage":"https://images.cointelegraph.com/images/1200_aHR0cHM6Ly9zMy5jb2ludGVsZWdyYXBoLmNvbS91cGxvYWRzLzIwMjEtMDcvMTcyZjMzZTgtOGQxZS00ZTVhLWFhMWYtODRjM2JkMzY0YzEzLmpwZw==.jpg","publishedAt":"2021-07-06T06:22:42Z","content":"Self-described Bitcoin King, Claudio Oliveira, has been arrested and charged by Brazilian federal police for allegedly masterminding a 1.5 billion reais (roughly $300 million) fraud scheme involving … [+2408 chars]"},{"source":{"id":null,"name":"Motley Fool Australia"},"author":"Bernd Struben","title":"This little known token has gained 40 times more than Bitcoin today","description":"With more than 4,000 cryptos in circulation, investors who can stomach the volatility have plenty to choose from.\nThe post This little known token has gained 40 times more than Bitcoin today appeared first on The Motley Fool Australia.","url":"https://www.fool.com.au/2021/07/06/this-little-known-token-has-gained-40-times-more-than-bitcoin-today/","urlToImage":"https://www.fool.com.au/wp-content/uploads/2021/06/crypto-16_9.jpg","publishedAt":"2021-07-06T06:22:03Z","content":"Bitcoin(CRYPTO: BTC) has rebounded from modest earlier losses to be up 1% over the past 24 hours.\r\nOne Bitcoin is currently worth US$34,611 (AU$45,540). That gives the world’s biggest crypto a market… [+2228 chars]"},{"source":{"id":null,"name":"BankInfoSecurity.com"},"author":null,"title":"Kaseya: Up to 1,500 Businesses Caught in Ransomware Attack","description":"A screenshot of Kaseya's remote IT management software VSA, which was compromised by ransomware attackers. (Source: Kaseya) Kaseya says late Monday that it believes between 800 to 1,500 mostly small businesses were compromised in a sweeping ransomware attack …","url":"https://www.bankinfosecurity.com/kaseya-up-to-1500-businesses-caught-in-ransomware-attack-a-16992","urlToImage":"https://130e178e8f8ba617604b-8aedd782b7d22cfe0d1146da69a52436.ssl.cf1.rackcdn.com/kaseya-up-to-1500-businesses-caught-in-ransomware-attack-showcase_image-2-a-16992.jpg","publishedAt":"2021-07-06T06:18:00Z","content":"3rd Party Risk Management\r\n ,\r\n Endpoint Security\r\n ,\r\n Fraud Management &amp; Cybercrime\r\nCompany Quiet on Whether It Will Pay for Universal Decryption ToolJeremy Kirk (jeremy_kirk) •\r\n July 6, 2021… [+5871 chars]"},{"source":{"id":null,"name":"Haber7.com"},"author":"Haber7","title":"Milyarderlerden coin paylaşımı! Elon Musk öne çıkardı","description":"Milyarder yatırımcı Warren Buffett'ın \"Bulabildiğiniz kadar çok coin bulun ve bunu hızlı yapın\" tweetini milyarder iş adamı Elon Musk paylaştı.","url":"https://ekonomi.haber7.com/ekonomi/haber/3117439-milyarderlerden-coin-paylasimi-elon-musk-one-cikardi","urlToImage":"https://i12.haber7.net//haber/haber7/photos/2020/28/efsanevi_yatirimci_buffettin_en_buyuk_hatasi_1594292482_2084.jpg","publishedAt":"2021-07-06T06:17:00Z","content":"Milyarder i adam Elon Musk, milyarder yatrmc Warren Buffett'n coin önerisini sosyal medya platformu Twitter'dan paylat. Buffett \"Bulabildiiniz kadar çok coin bulun ve bunu hzl yapn\" paylamn yapt. Mus… [+373 chars]"},{"source":{"id":null,"name":"Finance.ua"},"author":"Finance.UA","title":"В Украине расширили понятие банковской тайны","description":"Верховная Рада Украины приняла во втором чтении соответствующий законопроект.","url":"https://news.finance.ua/ru/news/-/496105/v-ukraine-rasshirili-ponyatie-bankovskoj-tajny","urlToImage":"http://resources.finance.ua/ru/news/image-repost?id=496105","publishedAt":"2021-07-06T06:16:00Z","content":"Bitcoin, e-sim, : monobank"},{"source":{"id":null,"name":"Patronlardunyasi.com"},"author":null,"title":"İşte Tosuncuk’un Latin Amerika’daki kayıp dört yılı; eşine Ferrari aldı","description":"Sözcü yazarı İsmail Saymaz, binlerce kişiyi dolandırarak, 2018 yılının Mart ayında yurt dışına kaçan ve kırmızı bültenle aranan Çiftlik Bank’ın kurucusu ‘Tosuncuk’ lakaplı Mehmet Aydın’ın son dört yılında neler yaşadığını kaleme aldı.","url":"https://www.patronlardunyasi.com/haber/Iste-Tosuncuk-un-Latin-Amerika-daki-kayip-dort-yili-esine-Ferrari-aldi/252652","urlToImage":"http://www.patronlardunyasi.com/haber_resim/Tosuncuk%2Dmilyarlari%2Dboyle%2Dyiyor%2D222401%2Ejpg","publishedAt":"2021-07-06T06:10:22Z","content":"Aydn’n Türkiye’ye dönme isteinin iki nedeni olabileceini ifade eden Saymaz, “Bir: Para suyunu çekti. ki: Tersine Bitcoin'den paray vurdu” dedi.\r\nPolisler tarafndan organizasyonun beyninin Mehmet Aydn… [+4731 chars]"},{"source":{"id":null,"name":"Haber7.com"},"author":null,"title":"Kriptoda yatırımı olanlar dikkat! İşlemleri durdurdular! Büyük hayal kırıklığı","description":"Barclays, müşterilerinin Binance'e kredi veya banka kartıyla ödeme yapmasına engel getirdi... - Sayfa 1","url":"https://www.haber7.com/foto-galeri/69428-kriptoda-yatirimi-olanlar-dikkat-islemleri-durdurdular","urlToImage":"https://i12.haber7.net//fotogaleri/haber7/album/2021/27/sANXx_1625552786_6736_w750_h500.jpg","publishedAt":"2021-07-06T06:10:00Z","content":"Para birimlerinin tarihçesiyle ilgili finans çevrelerinde oldukça ilgi gören “Para Komplosu” (The Money Plot) kitabnn ünlü yazar Frederick Kaufman dier para birimlerinin de kripto paralarla benzer de… [+1757 chars]"},{"source":{"id":null,"name":"Lefigaro.fr"},"author":"Le Figaro avec AFP","title":"Pékin avait recommandé à Didi de retarder son entrée en Bourse","description":"Didi, le «Uber chinois», objet d'une enquête de Pékin après son entrée en Bourse aux États-Unis, s'était vu suggérer par les autorités chinoises...","url":"https://www.lefigaro.fr/flash-eco/pekin-avait-recommande-a-didi-de-retarder-son-entree-en-bourse-20210706","urlToImage":"https://i.f1g.fr/media/cms/704x396_cropupscale/2021/07/06/cc1ce2180071a95f50a25bd9bd55038b103c3758ba977faa7784d332e85011eb.jpg","publishedAt":"2021-07-06T06:09:23Z","content":"Didi, le «Uber chinois», objet d'une enquête de Pékin après son entrée en Bourse aux États-Unis, s'était vu suggérer par les autorités chinoises de retarder l'opération mais a ignoré la recommandatio… [+2573 chars]"},{"source":{"id":null,"name":"Aviationanalysis.net"},"author":"Jeffrey Clark","title":"Fears among Dutch entrepreneurs after a cyber attack - Aviation Analysis Wing","description":"Affected Dutch SMEs are concerned about the consequences of last weekend’s massive cyber attack. Many cybersecurity officers receive calls about the hack. Insurance companies with which cybersecurity officers have contracts are also constantly called in.","url":"https://www.aviationanalysis.net/fears-among-dutch-entrepreneurs-after-a-cyber-attack/","urlToImage":null,"publishedAt":"2021-07-06T06:03:00Z","content":"Affected Dutch SMEs are concerned about the consequences of last weekend’s massive cyber attack. Many cybersecurity officers receive calls about the hack. Insurance companies with which cybersecurity… [+2952 chars]"},{"source":{"id":null,"name":"Wykop.pl"},"author":"Kolekcjoner_dusz","title":"Bitcoin. Nowe niemieckie prawo może przynieść miliardowe inwestycje w...","description":"Nowe niemieckie prawo może przynieść 415 mld dolarów inwestycji w kryptowaluty. Visa kontynuuje rozwój zespołu ds. kryptowalut, a fundusz inwestycyjny George'a Sorosa podobno handluje bitcoinem - pisze dla money.pl Simon Peters, analityk kryptowalut eToro.","url":"https://www.wykop.pl/link/6177655/bitcoin-nowe-niemieckie-prawo-moze-przyniesc-miliardowe-inwestycje-w/","urlToImage":"https://www.wykop.pl/cdn/c3397993/link_1625551233RTXyqNAYfFQ5tgEvvK4UD8,w1200h627f.jpg","publishedAt":"2021-07-06T06:01:39Z","content":"Drogi Wykopowiczu\r\nw zaczonym linku do Polityki Prywatnoci przypominamy podstawowe informacje z zakresu przetwarzania danych osobowych dostarczanych przez Ciebie podczas korzystania z naszego serwisu… [+108 chars]"},{"source":{"id":null,"name":"Elblogsalmon.com"},"author":"DerBlaueMond","title":"Invertir en acero está de moda, pero podría dañar la poca industria que queda en España","description":"Esta vez le ha tocado al acero. ¿Se trata sólo de un tentaculo más de ese monstruo de todo el dinero insuflado en el sistema por los tipos ultra-bajos Todos los operadores saben que esa liquidez masiva anda deambulando por el sistema huérfano, y buscando dese…","url":"https://www.elblogsalmon.com/entorno/invertir-acero-esta-moda-podria-danar-poca-industria-que-queda-espana","urlToImage":"https://i.blogs.es/9c2c1a/invertir-en-acero-esta-de-moda-pero-podria-danar-la-poca-industria-que-queda-en-espana---1/840_560.jpg","publishedAt":"2021-07-06T06:01:20Z","content":"Esta vez le ha tocado al acero. ¿Se trata sólo de un tentaculo más de ese monstruo de todo el dinero insuflado en el sistema por los tipos ultra-bajos Todos los operadores saben que esa liquidez masi… [+21425 chars]"},{"source":{"id":null,"name":"Www.bt.dk"},"author":"sboa@bt.dk (Simon Boas)","title":"It-ekspert efter nyt angreb: Kan i værste fald koste liv","description":"»Forestil dig, at det her rammer Sundhedsstyrelsen eller NemID.«","url":"https://www.bt.dk/samfund/it-ekspert-efter-nyt-angreb-kan-i-vaerste-fald-koste-liv","urlToImage":"https://bt.bmcdn.dk/media/cache/resolve/image_960x545/image/168/1687211/23796710-china-technology-hacking.jpg","publishedAt":"2021-07-06T06:01:00Z","content":"»Vi bliver nødt til at indse, at de it-kriminelle har kronede dage. De skal blot være heldige én gang, mens de, der forsvarer, skal være heldige konstant.«\r\nSådan lyder det fra Peter Kruse, der er it… [+3385 chars]"},{"source":{"id":null,"name":"Adslzone.net"},"author":"David Parra","title":"Estas criptomonedas no las conoce nadie, pero valen tanto o más que el Bitcoin","description":"El mundo de las criptomonedas es un tema de actualidad con mucho potencial para el futuro. Mucha gente ve en este dinero electrónico una nueva forma de realizar pagos como alternativa a la forma tradicional de pagar. Comprar criptomonedas puede suponer un eno…","url":"https://www.adslzone.net/noticias/fintech/criptomonedas-valiosas-mundo/","urlToImage":"https://www.adslzone.net/app/uploads-adslzone.net/2021/07/cripto-1.jpg","publishedAt":"2021-07-06T06:00:04Z","content":"El mundo de las criptomonedas es un tema de actualidad con mucho potencial para el futuro. Mucha gente ve en este dinero electrónico una nueva forma de realizar pagos como alternativa a la forma trad… [+2453 chars]"},{"source":{"id":null,"name":"Finance.ua"},"author":"Finance.UA","title":"Киев отменяет бумажные билеты в транспорте: как заплатить за проезд","description":"С 14 июля окончательно выйдут из обращения талоны на проезд, которые можно было приобрести у кондукторов.","url":"https://news.finance.ua/ru/news/-/496076/kiev-otmenyaet-bumazhnye-bilety-v-transporte-kak-zaplatit-za-proezd","urlToImage":"http://resources.finance.ua/ru/news/image-repost?id=496076","publishedAt":"2021-07-06T06:00:00Z","content":"Bitcoin, e-sim, : monobank"},{"source":{"id":null,"name":"Donanimhaber.com"},"author":"Yusuf Akbaş","title":"Dogecoin yeni bir rekor kırdı","description":"Eğlence amacıyla ortaya çıkan Dogecoin, aylık işlem hacmiyle yeni bir rekor kırdı. DOGE, en çok alınıp satılan beşinci kripto para birimi oldu.","url":"https://www.donanimhaber.com/dogecoin-yeni-bir-rekor-kirdi--135727","urlToImage":"https://www.donanimhaber.com/images/images/haber/135727/600x338dogecoin-yeni-bir-rekor-kirdi.jpg","publishedAt":"2021-07-06T06:00:00Z","content":"a').click()\"&gt;Tam Boyutta Gör\r\nPopüler meme coin DOGE, piyasa deeri sralamasna göre en iyi 10 kripto para biriminden biri haline geldi ve aylk 253 milyar dolarlk ilem hacmine ulat. \r\nÖzellikle Elon… [+1465 chars]"}]};
    return res;
}

listen(eventName:string)
{
  return new Observable((subscriber) => {
    this.socket.onopen(eventName,(data :any) => {
      subscriber.next(data);
    })
  })
}

emit(eventName:string,data:any)
{
  this.socket.emit(eventName,data);
}

}

